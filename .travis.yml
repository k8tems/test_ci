sudo: required

language: python

services:
  - docker

before_install:
  - gcloud -v
  - echo $GCLOUD_KEY | base64 --decode -i > ${HOME}/gcloud_key.json
  - gcloud config list project
  - gcloud auth activate-service-account $GCLOUD_EMAIL --key-file ${HOME}/gcloud_key.json
  - gcloud config list project
  - gcloud config set project $PROJECT_ID
  - gcloud config list project
  - docker info
  - docker build -t asia.gcr.io/test/test_ci .
  - gcloud docker -- push asia.gcr.io/test/test_ci

script: python -m test
